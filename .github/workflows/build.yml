name: Build Power Angel

on: [push, workflow_dispatch]

jobs:
  build:
    runs-on: windows-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Build with MSVC
      shell: cmd
      run: |
        echo Building Power Angel v8.0...
        echo ===========================
        
        :: Set up MSVC environment (simplified)
        call "C:\Program Files\Microsoft Visual Studio\2022\Enterprise\VC\Auxiliary\Build\vcvars64.bat"
        
        :: Simple compilation command
        cl /O2 /MT /DUNICODE /D_UNICODE /EHsc ^
          AngelSmartMichael.cpp ^
          /link ^
          shell32.lib ^
          winhttp.lib ^
          gdiplus.lib ^
          ole32.lib ^
          oleaut32.lib ^
          comctl32.lib ^
          user32.lib ^
          kernel32.lib ^
          advapi32.lib ^
          /SUBSYSTEM:WINDOWS ^
          /OUT:PowerAngel.exe
        
        if errorlevel 1 (
          echo ERROR: Compilation failed
          exit /b 1
        ) else (
          echo SUCCESS: Build completed
          dir PowerAngel.exe
        )
    
    - name: Upload artifact
      uses: actions/upload-artifact@v4
      with:
        name: PowerAngel
        path: PowerAngel.exe
